Python binary: /usr/bin/python
Python version: Python 3.9.10

Lmod is automatically replacing "gcc/11.3.0" with "intel/2021.6.0".


Lmod is automatically replacing "intel/2021.6.0" with "nvhpc/23.3-mpi".

wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: sathvikbhagavan (sathvikbhagavan-epfl). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.18.7
wandb: Run data is saved locally in /home/bhagavan/CS433/SteadyStateSplinePINNs/src/wandb/run-20241203_152148-rv5m4lmq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run golden-flower-10
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sathvikbhagavan-epfl/Spline-PINNs_with_validation
wandb: üöÄ View run at https://wandb.ai/sathvikbhagavan-epfl/Spline-PINNs_with_validation/runs/rv5m4lmq
Using device: cuda
0/100
Divergence Loss: 0.2542874486044277, X Momentum Loss: 3.1704049926704165, Y Momentum Loss: 0.3668109580410986, Z Momentum Loss: 0.0042470926060988136, Inlet Boundary Loss: 2.154435128185871, Other Boundary Loss: 2.0007794213157926, Total Loss: 419.3172054420884
Traceback (most recent call last):
  File "/home/bhagavan/CS433/SteadyStateSplinePINNs/src/spline_pinn.py", line 306, in <module>
    optimizer.step(closure)
  File "/home/bhagavan/.local/lib/python3.9/site-packages/torch/optim/optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
  File "/home/bhagavan/.local/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/bhagavan/.local/lib/python3.9/site-packages/torch/optim/lbfgs.py", line 444, in step
    loss, flat_grad, t, ls_func_evals = _strong_wolfe(
  File "/home/bhagavan/.local/lib/python3.9/site-packages/torch/optim/lbfgs.py", line 48, in _strong_wolfe
    f_new, g_new = obj_func(x, t, d)
  File "/home/bhagavan/.local/lib/python3.9/site-packages/torch/optim/lbfgs.py", line 442, in obj_func
    return self._directional_evaluate(closure, x, t, d)
  File "/home/bhagavan/.local/lib/python3.9/site-packages/torch/optim/lbfgs.py", line 296, in _directional_evaluate
    loss = float(closure())
  File "/home/bhagavan/.local/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/home/bhagavan/CS433/SteadyStateSplinePINNs/src/spline_pinn.py", line 303, in closure
    loss_total.backward()
  File "/home/bhagavan/.local/lib/python3.9/site-packages/torch/_tensor.py", line 572, in backward
    return handle_torch_function(
  File "/home/bhagavan/.local/lib/python3.9/site-packages/torch/overrides.py", line 1717, in handle_torch_function
    result = mode.__torch_function__(public_api, types, args, kwargs)
  File "/home/bhagavan/.local/lib/python3.9/site-packages/torch/utils/_device.py", line 106, in __torch_function__
    return func(*args, **kwargs)
  File "/home/bhagavan/.local/lib/python3.9/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/home/bhagavan/.local/lib/python3.9/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/bhagavan/.local/lib/python3.9/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: Trying to backward through the graph a second time (or directly access saved tensors after they have already been freed). Saved intermediate values of the graph are freed when you call .backward() or autograd.grad(). Specify retain_graph=True if you need to backward through the graph a second time or if you need to access saved tensors after calling backward.
[1;34mwandb[0m: üöÄ View run [33mgolden-flower-10[0m at: [34mhttps://wandb.ai/sathvikbhagavan-epfl/Spline-PINNs_with_validation/runs/rv5m4lmq[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20241203_152148-rv5m4lmq/logs[0m
srun: error: i16: task 0: Exited with exit code 1
srun: Terminating StepId=2481720.0
